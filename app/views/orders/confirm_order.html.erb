<h1>Confirm Order</h1>

<%= form_for @order, url: {action: 'create'} do |form| %>
  <div class="field">
    <p><b>User ID : </b><%= session[:user_id] %></p>
    <%= hidden_field(:order, :user_id, :value => session[:user_id]) %>
  </div>

  <fieldset>
    <% if @status %>
    <table>
      <tr valign="top">
        <td>
          <div class="field" style="border: 1px solid black; padding: 5px;">
            <p><b>Origin : </b></p>
            <p><%= @order.origin %></p>
            <p><b>Coordinate :</b></p>
            <p>Lat : <%= @origin[:lat] %></p>
            <p>Lng : <%= @origin[:lng] %></p>
            <%= hidden_field(:order, :origin, :value => @order.origin) %>
          </div>
        </td>

        <td>
          <div class="field" style="border: 1px solid black; padding: 5px;">
            <p><b>Destination : </b></p>
            <p><%= @order.destination %></p>
            <p><b>Coordinate :</b></p>
            <p>Lat : <%= @destination[:lat] %></p>
            <p>Lng : <%= @destination[:lng] %></p>
            <%= hidden_field(:order, :destination, :value => @order.destination) %>
          </div>
        </td>

        <td>
          <div class="field" style="border: 1px solid black; padding: 5px;">
            <p><b>Order Details : </b></p>
            <p><b>Service Type : </b><%= @order.service_type %></p>
            <%= hidden_field(:order, :service_type, :value => @order.service_type) %>

            <p><b>Distance : </b><%= @order.distance %> m</p>
            <%= hidden_field(:order, :distance, :value => @order.distance) %>
            
            <p><b>Price : </b><%= number_to_currency(@order.price, unit: "Rp. ", delimiter: ".", separator: ",") %></p>
            <%= hidden_field(:order, :price, :value => @order.price) %>
          </div>
        </td>

        <td>
          <div class="field" style="border: 1px solid black; padding: 5px;">
            <% if @driver %>
              <p><b>Driver Information : </b></p>
              <p><b>ID : </b><%= @driver.id %></p>
              <p><b>Name : </b><%= @driver.full_name %></p>
              <p><b>Phone : </b><%= @driver.phone %></p>
              <%= hidden_field(:order, :driver_id, :value => @driver.id) %>
            <% else %>
              <p>Your driver is unavailable at the moment</p>
            <% end %>
          </div>
        </td>
      </tr>
    </table>

      <div class="field">
        <%= form.label :payment_type %>
        <%= form.select(:payment_type, [['cash','cash'], ['gopay','gopay']]) %>
      </div>

      <div class="actions">
        <%= form.submit %>
      </div>

    <% else %>
      <p><b>Location is Invalid</b></p>
      <%= link_to "New Order", new_order_path %>
      <br>
    <% end %>  

    <br>
  </fieldset>
<% end %>